<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <title>Overall Status Page</title>
      <script type="text/javascript" src="Highcharts/js/jquery.min.js"></script>
      <script type="text/javascript" src="Highcharts/js/highcharts.js"></script>
    
      <script type="text/javascript">
         var chart;
         $(document).ready(function () {
             $(document).ready(function() {
                 Highcharts.setOptions({
                     global: {
                         useUTC: false
                     }
                 });
             
                 var chart;
                 $('#container').highcharts({
                     chart: {
                         type: 'spline',
                         animation: Highcharts.svg,
                         marginRight: 10,
                         events: {
                             load: function() {
                                
                                 // set up the updating of the chart each second
                                 var status_200_series = this.series[0];
                                 var status_500_series = this.series[1];
                                 
                                 setInterval(function() {
                                    
                                     $.ajax({
                                         url: '/data-visualizer/hello',
                                         type: 'GET',
                                         async: true,
                                         dataType: "json",
                                         success: function (data) {
                                   
                                             for(var i in data){
                                            	   console.info( data[i].code_200)
                                                   var time = data[i].time;
                                            	   status_200_series.addPoint([data[i].time, data[i].code_200], false, true);
                                            	   status_500_series.addPoint([data[i].time, data[i].code_500], true, true);
                                             }
                                         
                                         }
                                     });
                                  }, 1000);
                            }
                         }
                     },
                     title: {
                         text: 'Responses by code'
                     },
                     xAxis: {
                        min: (new Date()).getTime(),
                         type: 'datetime',
                         tickPixelInterval: 1000*60*10
                     },
                     yAxis: {
                             plotLines: [{
                             value: 0,
                             width: 1,
                             color: '#808080'
                         }]
                     },
                     tooltip: {
                         formatter: function() {
                                 return '<b>'+ this.series.name +'</b><br/>'+
                                 Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', this.x) +'<br/>'+
                                 Highcharts.numberFormat(this.y, 2);
                         }
                     },
                     legend: {
                         enabled: true
                     },
                     exporting: {
                         enabled: false
                     },
                     series: [{
                         name: '200',
                         data: (function() {
                                                          var data = [],
                                 time = (new Date()).getTime(),
                                 i;
             
                             for (i = -100; i <= 0; i++) {
                                 data.push({
                                     x: time + i * 1000,
                                     y: 1
                                 });
                             }
                             return data;
                         })()
                     },
                     {
                         name: '500',
                         data: (function() {
                             // generate an array of random data
                             var data = [],
                                 time = (new Date()).getTime(),
                                 i;
             
                             for (i = -100; i <= 0; i++) {
                                 data.push({
                                     x: time + i * 1000,
                                     y: Math.random()
                                 });
                             }
                             return data;
                         })()
                     }
                     
                     ]
                 });
             });
             
         });
      </script>
   </head>
   <body>
      <!-- 3. Add the container -->
      <div id="container" style="width: 100%; height: 400px; margin: 0 auto"></div>
   </body>
</html>